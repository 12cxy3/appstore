<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.zs.modules.app.dao.AppInfoDao">

    <resultMap type="com.zs.modules.app.entity.AppInfoEntity" id="appInfoMap">
        <result property="id" column="id"/>
        <result property="name" column="name"/>
        <result property="type" column="type"/>
        <result property="introduce" column="introduce"/>
        <result property="size" column="size"/>
        <result property="developer" column="developer"/>
        <result property="url" column="url"/>
        <result property="downNum" column="down_num"/>
        <result property="status" column="status"/>
        <result property="creator" column="creator"/>
        <result property="createDate" column="create_date"/>
        <result property="updater" column="updater"/>
        <result property="updateDate" column="update_date"/>
    </resultMap>
    <select id="getPage" resultType="com.zs.modules.app.dto.AppInfoDTO">
        select
            t1.*,
            t2.real_name createName,
            COUNT(t3.id) commentNum,
            ROUND(IFNULL(SUM(t3.score),0)/COUNT(t1.id),2) scoreNum
        from
            app_info t1
            left join sys_user t2
                on t1.creator = t2.id
            LEFT JOIN `app_comment` t3
                ON t1.id = t3.app_id
        ${ew.customSqlSegment}
    </select>


</mapper>